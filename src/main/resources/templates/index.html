<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Cloud Smoker</title>

	<!--
		<link rel="stylesheet"
		href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic|Material+Icons">
	<link rel="stylesheet" href="https://unpkg.com/vue-material/dist/vue-material.min.css">
	<link rel="stylesheet" href="https://unpkg.com/vue-material/dist/theme/default.css">
	-->

	<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">

</head>

<body>
	<div id="contents">

		<v-app>
			<v-app-bar app class="brown">
				<h1 class="md-title white--text">Smoker</h1>
			</v-app-bar>
			<v-main>
				<v-container>
					<v-row v-if="devices">
						<v-col cols="6">
							<v-select v-model="selected" :items="devices" item-text="id" item-value="id" label="Device">
							</v-select>
						</v-col>
						<v-col cols="6">
							<v-card class="pa-2" outlined tile v-if="selected">
								Firmware: {{state.firmware_version}}<br>
								Last status time: {{state.updateTime}}
							</v-card>
						</v-col>
					</v-row>

					<v-form @submit.prevent="submit" @submit="submitForm" :action=deviceUrl method="put" class=""
						ref="form" v-model="valid" lazy-validation>

						<v-radio-group v-model="config.mode" row v-if="selected">
							<v-radio label="Temperature limit" value="-2"></v-radio>
							<v-radio label="Time limit" value="-1"></v-radio>
							<v-radio label="Off" value="0"></v-radio>
							<v-radio label="On" value="100"></v-radio>
						</v-radio-group>

						<v-range-slider label="Min and Max" max="150" min="-50" v-model="minmax" v-if="config.mode==-2">
							<template v-slot:append>
								<v-text-field :value="minmax[0]" @change="$set(minmax, 0, $event)" class="mt-0 pt-0"
									hide-details single-line type="number" style="width: 60px"></v-text-field>
								<strong class="px-2 pt-2"> - </strong>
								<v-text-field :value="minmax[1]" @change="$set(minmax, 1, $event)" class="mt-0 pt-0"
									hide-details single-line type="number" style="width: 60px"></v-text-field>
							</template>
						</v-range-slider>

						<!--
					<v-slider label="Min" v-model="config.min" v-if="config.mode==-2" min="0" max="120">
						<template v-slot:append>
							<v-text-field v-model="config.min" class="mt-0 pt-0" hide-details single-line type="number"
								style="width: 60px"></v-text-field>
						</template>
					</v-slider>
					<v-slider label="Max" v-model="config.max" v-if="config.mode==-2" min="0" max="120">
						<template v-slot:append>
							<v-text-field v-model="config.max" class="mt-0 pt-0" hide-details single-line type="number"
								style="width: 60px"></v-text-field>
						</template>
					</v-slider>
					-->
						<v-slider label="On Minutes" v-model="config.onMins" v-if="config.mode==-1" min="0" max="1440">
							<template v-slot:append>
								<v-text-field v-model="config.onMins" class="mt-0 pt-0" hide-details single-line
									type="number" style="width: 60px"></v-text-field>
							</template>
						</v-slider>
						<v-slider label="Off Minutes" v-model="config.offMins" v-if="config.mode==-1" min="0"
							max="1440">
							<template v-slot:append>
								<v-text-field v-model="config.offMins" class="mt-0 pt-0" hide-details single-line
									type="number" style="width: 60px"></v-text-field>
							</template>
						</v-slider>
						<v-slider label="Max Minutes" v-model="config.maxMins" v-if="config.mode" min="0" max="28800">
							<template v-slot:append>
								<v-text-field v-model="config.maxMins" class="mt-0 pt-0" hide-details single-line
									type="number" style="width: 60px"></v-text-field>
							</template>
						</v-slider>

						<v-btn type="submit" id="submit" :disabled="!valid" color="primary" class="mr-4"
							@click="submitForm" v-if="selected">Set
							config</v-btn>
					</v-form>

					<line-chart v-if="selected" :series="series" />

					<!--

					<div>
						<div>Selected: {{ selected }}</div>
						<div>Config: {{ config }}</div>
						<div>State: {{ state }}</div>
						<div>Valid: {{ valid }}</div>
					</div>
					-->


				</v-container>
			</v-main>
		</v-app>

		<!--

		<md-app>

			<md-app-toolbar class="md-primary">
				<h1 class="md-title">Smoker</h1>
			</md-app-toolbar>

			<md-app-content class="xmd-layout">

				<div class="xmd-layout-item">
					<md-field>
						<md-select v-model="selected" @change="deviceSelected()" name="device" id="device"
							placeholder="Device">
							<md-option v-for="option in devices" v-bind:value="option.id">{{ option.id }}</md-option>
						</md-select>
					</md-field>
				</div>

				<form @submit="submitForm" :action=deviceUrl method="put" class="xmd-layout">

					<p v-if="errors.length">
						<b>Please correct the following error(s):</b>
					<ul>
						<li v-for="error in errors">{{ error }}</li>
					</ul>
					</p>

					<div class="" v-if="selected">
						<md-radio v-model="config.mode" value="-2">Temperature limit</md-radio>
						<md-radio v-model="config.mode" value="-1">Time limit</md-radio>
						<md-radio v-model="config.mode" value="0">Off</md-radio>
						<md-radio v-model="config.mode" value="100">On</md-radio>
					</div>

					<md-field class="md-layout md-gutter" v-if="config.mode==-2" width="150px" :style="{width:'150px'}">
						<label>Min</label>
						<md-input v-model="config.min" class="md-layout-item" width="150px" :style="{width:'150px'}">
						</md-input>
					</md-field>
					<md-field class="md-layout md-gutter" v-if="config.mode==-2">
						<vue-slider id="min" ref="slider" v-model="config.min" v-bind="sliderOptions"
							class="md-layout-item">
						</vue-slider>
					</md-field>

					<md-field class="xmd-layout-item" v-if="config.mode==-2">
						<label>Min</label>
						<md-input v-model="config.min">Min</md-input>
					</md-field>
					<md-field class="xmd-layout-item" v-if="config.mode==-2">
						<vue-slider id="min" ref="slider" v-model="config.min" v-bind="sliderOptions">
						</vue-slider>
					</md-field>
					<md-field class="xmd-layout-item" v-if="config.mode==-2">
						<label>Max</label>
						<md-input v-model="config.max">Max</md-input>
					</md-field>
					<md-field class="xmd-layout" v-if="config.mode==-2">
						<vue-slider id="max" ref="slider" v-model="config.max" v-bind="sliderOptions">
						</vue-slider>
					</md-field>
					<md-field class="xmd-layout-item" v-if="config.mode==-1">
						<label>On Minutes</label>
						<md-input class="" v-model="config.onMins" />
					</md-field>
					<md-field class="xmd-layout" v-if="config.mode==-1">
						<vue-slider id="onMins" ref="slider" v-model="config.onMins" v-bind="sliderOptions">
						</vue-slider>
					</md-field>
					<md-field class="xmd-layout-item" v-if="config.mode==-1">
						<label>Off Minutes</label>
						<md-input class="" v-model="config.offMins" />
					</md-field>
					<md-field class="md-layout" v-if="config.mode==-1">
						<vue-slider id="offMins" ref="slider" v-model="config.offMins" v-bind="sliderOptions">
						</vue-slider>
					</md-field>
					<md-field class="xmd-layout-item" v-if="config.mode">
						<label>Max Minutes</label>
						<md-input class="" v-model="config.maxMins" />
					</md-field>
					<md-field class="md-layout" v-if="config.mode">
						<vue-slider id="maxMins" ref="slider" v-model="config.maxMins" v-bind="sliderOptions">
						</vue-slider>
					</md-field>

					<div class="xmd-layout-item" v-if="selected">
						<md-button class="md-raised md-primary" type="submit" id="submit">Set config</md-button>
					</div>
				</form>


				<line-chart v-if="selected" :series="series" />


			</md-app-content>
		</md-app>
		-->
		<!-- 
				<div>Selected: {{ selected }}</div>
				<div>Config: {{ config }}</div>
				<div>State: {{ state }}</div>
				<div>INFO: {{ devices }}</div>
 -->
	</div>


	<!-- include Vue.js -->
	<!-- we include babel js so that we can write ES6 code in the browser
     for a more production like setup it is recommended to setup a build process
     to transpile and minify the code (such as using webpack)
 -->

	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

	<!--
	<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>


	<script src="https://unpkg.com/vue"></script>
	<script src="https://unpkg.com/vue-material"></script>



	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-slider-component@latest/theme/default.css">
	<script
		src="https://cdn.jsdelivr.net/npm/vue-slider-component@latest/dist/vue-slider-component.umd.min.js"></script>

	-->


	<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>


	<script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js'></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
	<script src="https://unpkg.com/vue-chartjs/dist/vue-chartjs.min.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>

	<script src="smoker.js"></script>

	<script type="text/babel">
	</script>
</body>

</html>